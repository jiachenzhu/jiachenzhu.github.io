/* 
 * Enhanced Mobile Styles
 * Fixes width issues and improves mobile experience
 */

/* ===== Mobile Width Fix ===== */
/* This is the critical fix for the narrow mobile layout */
@media (max-width: 768px) {
    /* Remove the conflicting width constraints on containers */
    .container,
    .container-sm,
    .container-md,
    .container-lg,
    .container-xl,
    .container-xxl {
      max-width: 100% !important; 
      width: 100% !important;
      padding-left: 15px;
      padding-right: 15px;
    }
    
    /* Update the col-lg-11 mx-auto that was restricting width */
    .col-lg-11.mx-auto {
      max-width: 100% !important;
      flex: 0 0 100% !important;
      padding-left: 15px;
      padding-right: 15px;
    }
    
    /* Fix any row negative margins that might be causing overflow */
    .row {
      margin-left: -10px;
      margin-right: -10px;
    }
    
    /* Fix any potential horizontal overflow issues */
    body, html {
      overflow-x: hidden;
      width: 100%;
      max-width: 100%;
    }
  }
  
  /* ===== Header Section Improvements ===== */
  @media (max-width: 768px) {
    .paper-title {
      font-size: 1.8rem; /* Smaller on mobile */
      line-height: 1.2;
    }
    
    /* Improve author listings on small screens */
    .author-line {
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin: 8px 0;
    }
    
    /* Better spacing for institution logos */
    .institution-logos {
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    
    /* Stack buttons for better mobile experience */
    .header-section .mt-4 {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    
    .header-section .btn {
      margin: 0 !important;
      width: 80%;
      max-width: 250px;
    }
  }
  
  /* ===== TLDR Section Improvements ===== */
  @media (max-width: 768px) {
    .tldr-box {
      padding: 20px !important; /* More compact padding */
    }
    
    .tldr-box h2 {
      font-size: 2rem !important;
    }
    
    .tldr-box p.lead {
      font-size: 1.1rem !important;
      text-align: left !important;
    }
    
    .key-findings .row {
      margin-left: 0;
      margin-right: 0;
    }
    
    .finding-card {
      height: auto !important;
      padding: 15px !important;
      margin-bottom: 15px;
    }
  }
  
  /* ===== Research Questions & Analysis Section ===== */
  @media (max-width: 768px) {
    /* Adjust navigation pills for mobile */
    .custom-nav-pills {
      flex-direction: column;
    }
    
    .custom-nav-pills .nav-link {
      margin: 5px 0;
      width: 100%;
      text-align: center;
      display: block;
    }
    
    /* Fix research questions */
    .research-question {
      padding: 15px !important;
    }
    
    .question-header {
      align-items: flex-start;
    }
    
    .question-title {
      font-size: 1.2rem !important;
    }
    
    /* Fix the charts and visualizations */
    .figure-container {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .figure-container img {
      max-width: 100%;
      height: auto;
    }
    
    /* Ensure tables aren't cut off */
    .table-responsive {
      display: block;
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
  }
  
  /* ===== Scaling Experiments Improvements ===== */
  @media (max-width: 768px) {
    .scaling-card {
      padding: 15px !important;
      margin-bottom: 15px;
    }
    
    .scaling-title {
      font-size: 1.3rem !important;
    }
    
    /* Make progress bars more visible */
    .progress {
      height: 14px !important;
    }
    
    /* Fix the stacking of columns */
    .col-md-5, .col-md-7 {
      width: 100%;
      padding-left: 5px;
      padding-right: 5px;
    }
    
    /* Fix element width in the charts */
    [style*="width: 80px; text-align: left;"] {
      width: 70px !important;
      font-size: 0.85rem !important;
    }
    
    [style*="width: 50px; text-align: right;"] {
      width: 45px !important;
      font-size: 0.85rem !important;
    }
  }
  
  /* ===== FAQ Section Improvements ===== */
  @media (max-width: 768px) {
    .accordion-button {
      padding: 15px !important;
      font-size: 1rem !important;
      line-height: 1.4 !important;
    }
    
    .accordion-body {
      padding: 15px !important;
      font-size: 0.95rem !important;
    }
  }
  
  /* ===== Better Touch Targets for Mobile ===== */
  @media (max-width: 768px) {
    a, button, .btn, .nav-link, .accordion-button {
      min-height: 44px;  /* Apple's recommended minimum touch target size */
      display: flex;
      align-items: center;
    }
    
    /* Ensure the figures in Question 4 display correctly */
    #question4 [style*="width: 225px; height: 225px;"] {
      width: 100% !important;
      height: auto !important;
      max-width: 225px;
      margin: 0 auto 15px auto !important;
    }
    
    #question4 [style*="width: 300px; height: 225px;"] {
      width: 100% !important;
      height: auto !important;
      object-fit: contain !important;
    }
  }
  
  /* Extra small devices (phones, 576px and down) */
  @media (max-width: 576px) {
    .paper-title {
      font-size: 1.6rem !important;
    }
    
    .equal-contribution {
      flex-direction: column !important;
    }
    
    .equal-contribution .mx-2 {
      display: none !important; /* Hide the separator on very small screens */
    }
    
    /* Further improve tables on very small screens */
    .data-table {
      font-size: 0.8rem !important;
    }
    
    /* Shrink content to fit smaller screens */
    #citation pre {
      font-size: 0.85rem !important;
      white-space: pre-wrap !important;
      word-break: break-word !important;
      padding: 15px !important;
    }
  }

/* 
 * Complete Mobile Layout Fix
 * Resolves narrow box issues on mobile devices
 */

/* ===== Mobile Width Fix ===== */
@media (max-width: 768px) {
    /* Reset container width constraints */
    .container,
    .container-sm,
    .container-md,
    .container-lg,
    .container-xl,
    .container-xxl {
      max-width: 100% !important; 
      width: 100% !important;
      padding-left: 15px;
      padding-right: 15px;
    }
    
    /* Remove width restrictions on main content */
    .col-lg-11.mx-auto {
      max-width: 100% !important;
      flex: 0 0 100% !important;
      padding-left: 10px;
      padding-right: 10px;
    }
    
    /* Fix row margins that may cause overflow */
    .row {
      margin-left: -10px;
      margin-right: -10px;
    }
    
    /* Prevent horizontal overflow */
    body, html {
      overflow-x: hidden;
      width: 100%;
      max-width: 100%;
    }
  
    /* Remove any fixed widths on individual sections */
    .section, .tldr-box, .research-question, 
    .scaling-card, .figure-container {
      width: 100% !important;
      max-width: 100% !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
      padding-left: 15px !important;
      padding-right: 15px !important;
      box-sizing: border-box !important;
    }
    
    /* Fix card layout */
    .card {
      width: 100% !important;
      min-width: auto !important;
      max-width: 100% !important;
    }
    
    /* Fix findings cards in TLDR section */
    .finding-card {
      width: 100% !important;
      min-width: auto !important;
      max-width: 100% !important;
      margin-bottom: 15px !important;
    }
    
    /* Fix custom navigation pills */
    .custom-nav-pills {
      width: 100% !important;
      max-width: 100% !important;
      flex-direction: column !important;
    }
    
    .custom-nav-pills .nav-link {
      width: 100% !important;
      max-width: 100% !important;
      margin-bottom: 5px !important;
    }
  
    /* Remove fixed width on tables and data containers */
    .table-responsive,
    .chart-container,
    .data-table {
      width: 100% !important;
      max-width: 100% !important;
      overflow-x: auto !important;
    }
    
    /* Ensure images scale properly */
    img {
      max-width: 100% !important;
      height: auto !important;
    }
  }
  
  /* ===== Specific Section Fixes ===== */
  @media (max-width: 768px) {
    /* TLDR Section */
    .tldr-box .row .col-md-12,
    .tldr-box .row .col-lg-12 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    .tldr-box .p-4 {
      padding: 15px !important;
    }
    
    /* Key findings cards */
    .key-findings .row {
      margin-left: 0 !important;
      margin-right: 0 !important;
    }
    
    .key-findings .col-md-4 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    /* Approach Section */
    #approach .col-md-4 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    /* Scaling Experiments */
    #scaling-experiments .col-md-5,
    #scaling-experiments .col-md-7 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    /* Research Questions */
    #research-questions .col-md-6 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    /* Fix progress bars */
    .d-flex.align-items-center {
      flex-wrap: nowrap !important;
    }
    
    /* Fix the comparison chart in Question 2 */
    .comparison-chart {
      padding: 10px !important;
    }
    
    /* OCR & Chart Section (Question 4) */
    #question4 .col-md-11 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
    
    #question4 .row.mx-0 {
      margin-left: 0 !important;
      margin-right: 0 !important;
    }
    
    #question4 .col-md-6 {
      padding-left: 5px !important;
      padding-right: 5px !important;
    }
  }
  
  /* ===== Very Small Devices ===== */
  @media (max-width: 576px) {
    /* Further container adjustments */
    .container,
    .container-sm,
    .container-md,
    .container-lg,
    .container-xl,
    .container-xxl {
      padding-left: 10px !important;
      padding-right: 10px !important;
    }
    
    /* Fix accordion buttons */
    .accordion-button {
      font-size: 0.95rem !important;
      padding: 12px !important;
    }
    
    /* Fix figure examples in Question 4 */
    #question4 [style*="width: 225px; height: 225px;"] {
      width: 100% !important;
      height: auto !important;
      max-width: 225px !important;
      margin: 0 auto 10px auto !important;
    }
    
    #question4 [style*="width: 300px; height: 225px;"] {
      width: 100% !important;
      height: auto !important;
      object-fit: contain !important;
    }
    
    /* Fix citation overflow */
    #citation pre {
      white-space: pre-wrap !important;
      word-break: break-word !important;
      font-size: 0.8rem !important;
    }
  }